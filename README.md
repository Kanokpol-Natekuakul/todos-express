# Todo Express Starter

แอปพลิเคชัน Todo List ที่สมบูรณ์ที่สร้างด้วย Express.js พร้อมระบบยืนยันตัวตน การจัดการเซสชัน และอินเทอร์เฟซที่สวยงามในสไตล์ TodoMVC

## เครดิต

โปรเจกต์นี้สร้างจากเทมเพลตเริ่มต้นที่ยอดเยียม:
```bash
git clone https://github.com/passport/todos-express-starter.git
```

ผู้สร้างต้นฉบับ: [Jared Hanson](https://www.jaredhanson.me/)  
เป็นส่วนหนึ่งของโปรเจกต์ [TodoMVC](https://todomvc.com)  
ระบบยืนยันตัวตนขับเคลื่อนโดย [Passport.js](https://www.passportjs.org)

## คุณสมบัติ

- **ระบบยืนยันตัวตน**: เข้าสู่ระบบ/สมัครสมาชิกที่ปลอดภัยด้วยชื่อผู้ใช้และรหัสผ่าน
- **การจัดการเซสชัน**: เซสชันผู้ใช้ที่คงอยู่ด้วยการจัดเก็บ SQLite
- **การจัดการ Todo**: สร้าง อ่าน อัปเดต และลบ todo
- **การกรอง**: ดู todo ทั้งหมด ที่ใช้งานอยู่ หรือเสร็จแล้ว
- **การดำเนินการแบบกลุ่ม**: สลับสถานะ todo ทั้งหมด หรือล้าง todo ที่เสร็จแล้ว
- **การออกแบบที่ตอบสนอง**: อินเทอร์เฟซที่สะอาดและเป็นมิตรกับมือถือ
- **การจัดเก็บข้อมูลถาวร**: ฐานข้อมูล SQLite สำหรับผู้ใช้และ todo

## เทคโนโลยีที่ใช้

- **Backend**: Node.js, Express.js
- **ระบบยืนยันตัวตน**: Passport.js ด้วย Local Strategy
- **ฐานข้อมูล**: SQLite3 พร้อมสคีมาที่กำหนดเอง
- **การจัดเก็บเซสชัน**: การจัดเก็บเซสชันแบบ SQLite
- **View Engine**: เทมเพลต EJS
- **การจัดแต่งหน้าตา**: CSS ที่กำหนดเองพร้อมสไตล์ TodoMVC
- **ความปลอดภัย**: การแฮชรหัสผ่าน PBKDF2 ด้วย salt

## ข้อกำหนดเบื้องต้น

- Node.js (เวอร์ชัน 12 ขึ้นไป)
- npm หรือ yarn package manager

## การติดตั้ง

1. โคลน repository:
```bash
git clone https://github.com/passport/todos-express-starter.git
cd todos-express-starter
```

2. ติดตั้ง dependencies:
```bash
npm install
```

3. สร้างไฟล์การตั้งค่าสภาพแวดล้อม (เป็นตัวเลือก):
```bash
cp .env.example .env
```

4. เริ่มต้นแอปพลิเคชัน:
```bash
npm start
```

5. เปิดเบราว์เซอร์และไปที่:
```
http://localhost:3000
```

## บัญชีผู้ใช้เริ่มต้น

สำหรับการทดสอบ มีการสร้างบัญชีผู้ใช้เริ่มต้น:
- **ชื่อผู้ใช้**: `kanokpol`
- **รหัสผ่าน**: `123456`

## โครงสร้างโปรเจกต์

```
├── app.js                 # แอปพลิเคชัน Express หลัก
├── bin/www               # สคริปต์เริ่มต้นเซิร์ฟเวอร์
├── db.js                 # การตั้งค่าและเริ่มต้นฐานข้อมูล
├── package.json          # dependencies และสคริปต์ของโปรเจกต์
├── LICENSE               # ลิขสิทธิ์สาธารณะ (Unlicense)
├── routes/
│   ├── auth.js          # เส้นทางระบบยืนยันตัวตน (เข้าสู่ระบบ, สมัครสมาชิก, ออกจากระบบ)
│   └── index.js         # เส้นทางการจัดการ Todo
├── views/
│   ├── error.ejs        # เทมเพลตหน้าแสดงข้อผิดพลาด
│   ├── home.ejs         # หน้าแรกสำหรับผู้ใช้ที่ยังไม่ได้ยืนยันตัวตน
│   ├── index.ejs        # อินเทอร์เฟซแอปพลิเคชัน Todo หลัก
│   ├── login.ejs        # ฟอร์มเข้าสู่ระบบ
│   ├── signup.ejs       # ฟอร์มสมัครสมาชิก
│   └── login/email/     # เทมเพลตยืนยันอีเมล
├── public/
│   └── css/
│       ├── app.css      # สไตล์การนำทางและอินเทอร์เฟซผู้ใช้
│       ├── base.css     # สไตล์ TodoMVC พื้นฐาน
│       ├── home.css     # สไตล์หน้าแรก
│       ├── index.css    # สไตล์แอปพลิเคชันหลัก
│       └── login.css    # สไตล์ฟอร์มยืนยันตัวตน
└── var/db/              # ไฟล์ฐานข้อมูล (สร้างอัตโนมัติ)
```

## สคีมาฐานข้อมูล

แอปพลิเคชันใช้ SQLite พร้อมตารางหลัก 3 ตาราง:

### ตารางผู้ใช้ (Users)
```sql
CREATE TABLE users (
    id INTEGER PRIMARY KEY,
    username TEXT UNIQUE,
    hashed_password BLOB,
    salt BLOB,
    name TEXT,
    email TEXT UNIQUE,
    email_verified INTEGER
);
```

### ตาราง Todos
```sql
CREATE TABLE todos (
    id INTEGER PRIMARY KEY,
    owner_id INTEGER NOT NULL,
    title TEXT NOT NULL,
    completed INTEGER
);
```

### ตารางข้อมูลยืนยันตัวตนแบบ Federated
```sql
CREATE TABLE federated_credentials (
    id INTEGER PRIMARY KEY,
    user_id INTEGER NOT NULL,
    provider TEXT NOT NULL,
    subject TEXT NOT NULL,
    UNIQUE (provider, subject)
);
```

## API Endpoints

### เส้นทางระบบยืนยันตัวตน
- `GET /login` - แสดงฟอร์มเข้าสู่ระบบ
- `POST /login/password` - ประมวลผลข้อมูลเข้าสู่ระบบ
- `POST /logout` - ออกจากระบบผู้ใช้
- `GET /signup` - แสดงฟอร์มสมัครสมาชิก
- `POST /signup` - ประมวลผลการสมัครสมาชิกใหม่

### เส้นทางการจัดการ Todo
- `GET /` - แสดง todo ทั้งหมด (ต้องยืนยันตัวตน)
- `GET /active` - แสดง todo ที่ใช้งานอยู่ (ยังไม่เสร็จ)
- `GET /completed` - แสดง todo ที่เสร็จแล้ว
- `POST /` - สร้าง todo ใหม่
- `POST /:id` - อัปเดต todo ที่มีอยู่
- `POST /:id/delete` - ลบ todo ที่ระบุ
- `POST /toggle-all` - สลับสถานะการเสร็จสิ้นของ todo ทั้งหมด
- `POST /clear-completed` - ลบ todo ที่เสร็จแล้วทั้งหมด

## การตั้งค่า

### ตัวแปรสภาพแวดล้อม
สร้างไฟล์ `.env` สำหรับการตั้งค่าที่กำหนดเอง:
```bash
PORT=3000                    # พอร์ตเซิร์ฟเวอร์
SESSION_SECRET=keyboard_cat  # คีย์เข้ารหัสเซสชัน
NODE_ENV=development         # โหมดสภาพแวดล้อม
```

### การตั้งค่าเซสชัน
เซสชันจัดเก็บใน SQLite (`var/db/sessions.db`) ด้วยการตั้งค่าดังนี้:
- คีย์ลับสำหรับการเข้ารหัส
- ไม่บันทึกอัตโนมัติสำหรับเซสชันที่ไม่ได้เริ่มต้น
- การจัดเก็บถาวรข้ามการรีสตาร์ทเซิร์ฟเวอร์

## คุณสมบัติด้านความปลอดภัย

- **การแฮชรหัสผ่าน**: PBKDF2 ด้วย SHA-256 และ salt แบบสุ่ม
- **ความปลอดภัยเซสชัน**: การจัดเก็บเซสชันที่เข้ารหัส
- **การป้องกัน SQL Injection**: คิวรีแบบพารามิเตอร์
- **การป้องกัน CSRF**: การส่งฟอร์มพร้อมการตรวจสอบที่เหมาะสม
- **การตรวจสอบข้อมูลนำเข้า**: การตรวจสอบฝั่งเซิร์ฟเวอร์สำหรับข้อมูลผู้ใช้ทั้งหมด

## การพัฒนา

### การรันในโหมดพัฒนา
```bash
npm start
```
เซิร์ฟเวอร์จะเริ่มต้นที่พอร์ต 3000 พร้อมการบันทึกล็อกสำหรับการพัฒนา

### การรีเซ็ตฐานข้อมูล
หากต้องการรีเซ็ตฐานข้อมูล เพียงลบไฟล์ฐานข้อมูล:
```bash
rm -rf var/db/
```
ฐานข้อมูลจะถูกสร้างใหม่ในการเริ่มต้นครั้งถัดไป

## ลิขสิทธิ์

ซอฟต์แวร์นี้เผยแพร่สู่สาธารณะภายใต้ [Unlicense](http://unlicense.org/) คุณมีอิสระในการใช้ แก้ไข และแจกจ่ายโค้ดนี้เพื่อวัตถุประสงค์ใดๆ ทั้งเชิงพาณิชย์และไม่เชิงพาณิชย์

## การมีส่วนร่วม

นี่คือเทมเพลตเริ่มต้นที่ออกแบบมาสำหรับการเรียนรู้และการทดลอง สามารถ fork และแก้ไขตามความต้องการของคุณได้

## การสนับสนุน

สำหรับคำถามเกี่ยวกับกลยุทธ์การยืนยันตัวตน Passport.js เข้าชม [เอกสาร Passport.js](https://www.passportjs.org/docs/)

สำหรับคำถามที่เกี่ยวข้องกับ TodoMVC ตรวจสอบได้ที่ [เว็บไซต์ TodoMVC](https://todomvc.com)

---

**ขอให้การเขียนโค้ดเป็นไปด้วยดี! 🚀**
